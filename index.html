<!DOCTYPE html>
<!-- Horizontal Scrolling Trick from http://css-tricks.com/examples/HorzScrolling/ -->
<html>
	<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="UTF-8">
	
	<title>Digital Narrative</title>
	
	<link rel="stylesheet" href="./css/styles.css">
	
	<script src="./lib/jquery.min.js"></script>
	<script src="./lib/jquery.mousewheel.js"></script>
	<script src="./lib/bootstrap-modal.js"></script>
	<script src="./lib/underscore-min.js"></script>
	
	<script src="./js/content.js"></script>
</head>

<body>
	
	<h1>Walking the Border</h1>

	<div id="page-wrap"><table cellspacing="30"><tbody>
		<tr id="posts"></tr>
	</tbody></table></div>

	<script>

	$(function(){
		$("#page-wrap").wrapInner("<table cellspacing='30'><tr>");

		$(".post").wrap("<td></td>");

		// Map scroll to horizontal
		$("body, html").mousewheel(function(event, delta) {
			this.scrollLeft -= (delta * 30);
			event.preventDefault();
		});   
	});

	console.log(sections);
	console.log(sentences);

	renderSections();

	function renderSections(){
		var acc = _.reduce(sections, function(memo, section){
			return memo + '<td><div class="post">' + renderSentences(section) + "</div></td>";
		}, 0);

		$("#posts").html(acc);
	}

	function renderSentences(section){
		var ids = [];

		for (var i = 1; i <= section.sentences; i++) {

			// Generate prefix
			var prefix = null;
			if (i < 10) prefix = "00";
			if (i >= 10) prefix = "0"

			ids.push(section.id + prefix + i);
		};

		var acc = "";

		_.each(ids, function(id){
			var sentence = _.findWhere(sentences, {id : id});
			acc += '<span class="highlight ' + sentence.link + '">' + sentence.sentence + "</span>";
		})

		acc = "<p>" + acc + "</p>";

		return acc;
	}

	</script>
 </body></html>